---
import { getCollection } from 'astro:content';
import BaseLayout from '../../layouts/BaseLayout.astro';

const entries = await getCollection('archive');

const toIsoDate = (value: Date) => value.toISOString().slice(0, 10);

const sortedEntries = [...entries].sort((a, b) => b.data.date.getTime() - a.data.date.getTime());
---

<BaseLayout title="Past content | snakamoto404.github.io">
  <section class="space-y-6">
    <div class="space-y-2">
      <h1 class="text-3xl font-semibold tracking-tight">Past content</h1>
      <p class="text-sm text-foreground/80">Browse all available daily entries.</p>
    </div>

    {
      sortedEntries.length ? (
        <ul class="space-y-3">
          {sortedEntries.map((entry) => (
            <li class="panel">
              <a href={`/archive/${toIsoDate(entry.data.date)}/`} class="text-base font-semibold hover:text-accent">
                {toIsoDate(entry.data.date)}
              </a>
              <p class="mt-2 text-sm text-foreground/85">{entry.data.summary ?? 'No summary provided.'}</p>
            </li>
          ))}
        </ul>
      ) : (
        <div class="panel">
          <p>No archive entries found.</p>
        </div>
      )
    }
  </section>
</BaseLayout>
